FROM ansibleplaybookbundle/apb-base:canary

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGRlbW8tZGItYXBiCmRlc2NyaXB0aW9uOiBEZXBsb3lzIGEgZGVt\
byBkYXRhYmFzZQpiaW5kYWJsZTogVHJ1ZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlz\
cGxheU5hbWU6IERlbW8gRGF0YWJhc2UgKEFQQikKICBkZXBlbmRlbmNpZXM6IFsnZG9ja2VyLmlv\
L2NlbnRvcy9wb3N0Z3Jlc3FsLTk1LWNlbnRvczcnXQogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2lj\
b25DbGFzczogaWNvbi1wb3N0Z3Jlc3FsCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQs\
IEluYy4iCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEEgc2FtcGxl\
IEFQQiB3aGljaCBkZXBsb3lzIERlbW8gRGF0YWJhc2UKICAgIGZyZWU6IFRydWUKICAgIG1ldGFk\
YXRhOgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246IFRo\
aXMgcGxhbiBkZXBsb3lzIGEgUG9zdGdyZXMgRGF0YWJhc2UgdGhlIGRlbW8gYXBwbGljYXRpb24g\
Y2FuIGNvbm5lY3QgdG8KICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0g\
bmFtZTogcG9zdGdyZXNxbF9kYXRhYmFzZQogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFi\
YXNlIE5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAg\
ICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFVzZXIK\
ICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAtIG5hbWU6\
IHBvc3RncmVzcWxfcGFzc3dvcmQKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29yZAog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
